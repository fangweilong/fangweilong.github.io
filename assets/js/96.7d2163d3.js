(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{468:function(s,a,n){"use strict";n.r(a);var t=n(1),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"cetnos7通过nfs共享磁盘文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cetnos7通过nfs共享磁盘文件"}},[s._v("#")]),s._v(" cetnos7通过nfs共享磁盘文件")]),s._v(" "),a("p",[s._v("环境：centos7\n服务器：两台,一台做服务端，一台做客户端\n以下命令都假设基于root权限下进行，不加sudo前缀了。")]),s._v(" "),a("h3",{attrs:{id:"安装服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装服务端"}},[s._v("#")]),s._v(" 安装服务端")]),s._v(" "),a("p",[s._v("假定IP为：192.168.100.100")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nfs-utils\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启自启")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nfs\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动服务")]),s._v("\nsystemctl start nfs\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"配置服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置服务端"}},[s._v("#")]),s._v(" 配置服务端")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置共享目录 最终的共享目录为:/data/share")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /data\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" share\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置nfs的挂载目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/exports\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("配置内容")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例1 根据 IP 地址范围限制访问")]),s._v("\n/data/share/ "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".200.200/24"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,sync,no_root_squash,no_all_squash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例2 使用 * 表示访问不加限制")]),s._v("\n/data/share/ *"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,sync,no_root_squash,no_all_squash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果对权限不是要求特别严格，可以直接使用括号内的参数，以下是对参数的一些解释：")]),s._v(" "),a("ul",[a("li",[s._v("/mnt/kvm/：需要共享的目录")]),s._v(" "),a("li",[s._v("192.168.1.1/24：客户端 IP 范围，*表示无限制。最好是指定ip")]),s._v(" "),a("li",[s._v("rw：权限设置，可读可写")]),s._v(" "),a("li",[s._v("sync：同步共享目录")]),s._v(" "),a("li",[s._v("no_root_squash：可以使用root授权")]),s._v(" "),a("li",[s._v("no_all_squash：可以使用普通用户授权")])]),s._v(" "),a("p",[s._v("重启nfs服务")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl restart nfs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"安装客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装客户端"}},[s._v("#")]),s._v(" 安装客户端")]),s._v(" "),a("p",[s._v("假定IP为：192.168.200.200")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装客户端")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nfs-utils\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看服务端共享目录")]),s._v("\nshowmount "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.100\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 输出结果为：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Export list for 192.168.100.100")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## /data/share *")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建本地共享目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /data/share\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 临时挂载。挂载完以后可以在两边分别创建文件，就会发现文件同步了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" nfs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.100:/data/share /data/share\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"客户端永久挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#客户端永久挂载"}},[s._v("#")]),s._v(" 客户端永久挂载")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置自启动挂载。相比较于上面的临时挂载，配置文件中的挂载即便服务器重启，共享也不会丢")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/fstab\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("文件内输入内容：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.100:/data/share /data/share nfs defaults "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("内容的一些解释：")]),s._v(" "),a("ul",[a("li",[s._v("第一列：\nip地址和挂载的目录。这个看nfs服务端的配置")]),s._v(" "),a("li",[s._v("第二列：\n本客户端需要挂载到共享中的目录")]),s._v(" "),a("li",[s._v("第三列：\n磁盘类型，ext4、ext3、nfs各种类型")]),s._v(" "),a("li",[s._v("第四列：\n"),a("ul",[a("li",[s._v("async/sync：设置是否为同步方式运行，默认为async")]),s._v(" "),a("li",[s._v("auto/noauto：当下载mount -a 的命令时，此文件系统是否被主动挂载。默认为auto")]),s._v(" "),a("li",[s._v("rw/ro： 是否以以只读或者读写模式挂载")]),s._v(" "),a("li",[s._v('exec/noexec：限制此文件系统内是否能够进行"执行"的操作')]),s._v(" "),a("li",[s._v("user/nouser：是否允许用户使用mount命令挂载")]),s._v(" "),a("li",[s._v("suid/nosuid：是否允许SUID的存在")]),s._v(" "),a("li",[s._v("usrquota：启动文件系统支持磁盘配额模式")]),s._v(" "),a("li",[s._v("grpquota：启动文件系统对群组磁盘配额模式的支持")]),s._v(" "),a("li",[s._v("defaults：同时具有rw,suid,dev,exec,auto,nouser,async等默认参数的设置")])])]),s._v(" "),a("li",[s._v("第五列：\n"),a("ul",[a("li",[s._v("0：代表不要做dump备份")]),s._v(" "),a("li",[s._v("1：代表要每天进行dump的操作")]),s._v(" "),a("li",[s._v("2：代表不定日期的进行dump操作")])])]),s._v(" "),a("li",[s._v("第六列：\n"),a("ul",[a("li",[s._v("0：不要检验")]),s._v(" "),a("li",[s._v("1：最早检验（一般根目录会选择）")]),s._v(" "),a("li",[s._v("2：1级别检验完成之后进行检验")])])])]),s._v(" "),a("p",[s._v("配置完成后重新加载配置：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl daemon-reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);